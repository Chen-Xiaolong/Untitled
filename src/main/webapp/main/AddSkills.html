<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>就业分析系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Bluth Company">
    <link rel="shortcut icon" href="assets/ico/favicon.html">
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <link href="assets/css/theme.css" rel="stylesheet">
    <link href="assets/css/font-awesome.min.css" rel="stylesheet">
    <link href="assets/css/alertify.css" rel="stylesheet">
    <link rel="Favicon Icon" href="favicon.ico">
<!--    <link href="http://fonts.useso.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css">-->
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="assets/css/colorpicker.css" rel="stylesheet">
    <link href="assets/css/datepicker.css" rel="stylesheet">
    <link href="assets/css/timepicker.css" rel="stylesheet">
    <link href="assets/css/select2.css" rel="stylesheet">
    <script type="text/javascript" src="assets/js/jquery.min.js"></script>
<!--    <script type="text/javascript" src="assets/js/jquery.min.js"></script>-->
    <style type="text/css">
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f6f6f6;
            min-width: 200px;
            overflow: auto;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }
        .handle{
            cursor:pointer;
        }
        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }
        .dropdown a:hover {background-color: #ddd}
        .show {
            display:block;
        }
        .bar{
            height: 260px;
            overflow-y: auto;
        }
        .dropbtn {
            background-color: #4CAF50;
            color: white;
            padding: 16px;
            font-size: 16px;
            border: none;
            cursor: pointer;
        }

        .dropbtn:hover, .dropbtn:focus {
            background-color: #3e8e41;
        }
        #myInput {
            border-box: box-sizing;
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAACYktHRAD/h4/MvwAAAAl2cEFnAAABKgAAASkAUBZlMQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxMy0wNC0xMFQwNjo1OTowNy0wNzowMI5BiVEAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTMtMDQtMTBUMDY6NTk6MDctMDc6MDD/HDHtAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAABF0RVh0VGl0bGUAc2VhcmNoLWljb27Cg+x9AAACKklEQVQ4T6WUSavqQBCFK+2sII7gShFXLpUsBBHFf+1KcAQFwaWiolsnnBDn++4p0iHRqPDuByFJd/Wp6qrqVn5+IQP3+52m0ymtVis6Ho885na7KRgMUiKR4O9vmEQHgwGNx2NyOp0khCBFUXgcJo/Hg67XK8ViMcpkMjz+Dl200+nQZrMhh8PBE4gYQgDidrudvzEOm2KxyP9WsCginM1mHKEUS6VSFA6HOWI4G41GPAfx2+1GgUCAVFXVZMwovwY/lUqFPB4PiyFn+XxemzbT6/VovV6z8Ol0olwux+LPCBQFEQKIvhME2WyWbWGHFCD/VghUGVvE1rDlb6TTabbFmuVyqY2aEWgbFALeI5GINvyeUCjEtlgju+IZoRWfkS30CURoxFJUNjMEt9stf38CNjJKIFvNiMBJgTebzcZt843hcMhCELWqPBDxeJwulwtvC/3X7/e1qVfgFD0rC5tMJrUZM8Lr9VI0GmVBRDCfz6nZbHI/Sna7HXW7XZpMJtxSiBIP1lmhH9NqtaqfGKQDTmQREBnSgwfmMqfYYblc1o+2xHShtNttLgSiee4EmMEp3hDBPJzikimVSuRyuTTLJ1GwWCz4pCB3UhiL/X4/Hw50C5zjLSM+n898weCogxdRIzAGxigAdtNqtV6EC4UC+Xy+z6Kf2O/31Gg0TMK4ZBDxf4uCw+FA9XpdF0aaUOg/iQLcHbVaTb/p0Cl/FgXIJ/oYnaCqKv0DC6dltH6Ks84AAAAASUVORK5CYII=");
            background-position: 14px 12px;
            background-repeat: no-repeat;
            font-size: 16px;
            padding: 14px 20px 12px 45px;
            border: none;
        }
        .myli{
            margin-top: 10px;
        }
        .hide{display: none;}
        .dropdown {
            position: relative;
            display: inline-block;
        }
    </style>
</head>
<body>
<div id="wrap">
    <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container-fluid">
                <div class="logo">
<!--                    <img src="assets/img/logo.png" alt="Realm Admin Template">-->
                    <p style="color: white; font-size: 20px;">就业分析系统</p>
                </div>
                <a class="btn btn-navbar visible-phone" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>
                <a class="btn btn-navbar slide_menu_left visible-tablet">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>

                <div class="top-menu visible-desktop">
                    <ul class="pull-left">
                        <li><a id="messages" data-notification="2" href="#"><i class="icon-envelope"></i> 消息</a></li>
                    </ul>
                    <ul class="pull-right">
                        <li><a href="../../Untitled/login/index.html"><i class="icon-off"></i> 退出</a></li>
                    </ul>
                </div>

                <div class="top-menu visible-phone visible-tablet">
                    <ul class="pull-right">
                        <li><a title="link to View all Messages page, no popover in phone view or tablet" href="#"><i class="icon-envelope"></i></a></li>
                        <li><a title="link to View all Notifications page, no popover in phone view or tablet" href="#"><i class="icon-globe"></i></a></li>
                        <li><a href="login.html"><i class="icon-off"></i></a></li>
                    </ul>
                </div>

            </div>
        </div>
    </div>

    <div class="container-fluid">

        <!-- Side menu -->
        <div class="sidebar-nav nav-collapse collapse">
            <div class="user_side clearfix">
                <img src="assets/img/odinn.jpg" alt="Odinn god of Thunder">
                <h5>newuser</h5>
                <a href="#"><i class="icon-cog"></i> 个人中心</a>
            </div>
            <div class="accordion" id="accordion2">
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <a class="accordion-toggle b_F79999" href="AddSkills.html"><i class="icon-dashboard"></i> <span>添加技能</span></a>
                    </div>
                </div>
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <a class="accordion-toggle b_C1F8A9" href="recommend.html"><i class="icon-bar-chart"></i> <span>岗位推荐</span></a>
                    </div>
                </div>
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <a class="accordion-toggle b_9FDDF6" href="postview.html"><i class="icon-bullhorn"></i> <span>岗位浏览</span></a>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Side menu -->

        <!-- Main window -->
        <div class="main_container" id="forms_page">
            <div class="row-fluid">
                <ul class="breadcrumb">
                    <li><a href="#">主页</a> <span class="divider">/</span></li>
                    <li class="active">添加技能</li>
                </ul>
                <h2 class="heading">
                    添加技能
                </h2>
            </div>
            <div class="row-fluid">
                <div class="widget widget-padding span12">
                    <div class="widget-header">
                        <i class="icon-external-link"></i><h5>已拥有技能</h5>
                        <div class="widget-buttons">
                            <a href="#" data-title="Collapse" data-collapsed="false" class="tip collapse"><i class="icon-chevron-up"></i></a>
                        </div>
                    </div>
                    <div class="widget-body" style="padding-right: 15%" id="oldskill">
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="widget widget-padding span12">
                    <div class="widget-header">
                        <i class="icon-list-alt"></i><h5>新增技能</h5>
                        <div class="widget-buttons">
                            <a href="#" data-title="Collapse" data-collapsed="false" class="tip collapse"><i class="icon-chevron-up"></i></a>
                        </div>
                    </div>
                    <div class="widget-body width" >
                                <button onclick="myFunction()" id="mybt" style="background-color: white;color: grey; min-width: 150px;" class="btn  btn-primary">添加技能</button>
<!--                                <button onclick="changeclass()" class="btn btn-primary">更改技能熟练度</button>-->
                                <select style="margin-top: 10px" id="abcd">
                                    <option >了解</option>
                                    <option  selected>掌握</option>
                                    <option >熟练</option>
                                    <option >精通</option>
                                    <option >大师</option>
                                </select>
                                <button onclick="addline()" class="btn  btn-primary">+</button>
                                        <div  id="input1" class="dropdown-content ">
<!--                                            <input type='text' style='height: 40px' placeholder='搜索..' id='myInput' onkeyup='filterFunction()'>-->
                                            <input type="text" style="height: 40px" placeholder="搜索.." id="myInput" onkeyup="filterFunction()">
                                            <div id="input2" class="bar">

                                            </div>
                                        </div>
                                        <h2 id="addskilltxt" style="font-size: 20px"></h2>
                    </div>
                </div>
                <div class="widget-footer">
                    <button class="btn btn-primary" id="add">保存</button>
                    <button class="btn" id="clear">删除</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
<!--    删除已有技能-->
    function deletebtn(id) {
    console.log(id);
            var z={};
            var x=id.innerText;
            console.log(x.trim());
            z.skill=x.trim();
            console.log(z);
            $.post("http://localhost:8080/Untitled/user/deleteSkill",
            z,
            function (data) {
                if (data.status==3) {
                    alert("删除成功");
                    document.getElementById('oldskill').innerHTML="";
                    new getskills();
                    // w.removeChild(id);
                }
                console.log(data);
            })
    }


    function myFunction() {
        document.getElementById("input1").classList.remove("hide");
        document.getElementById("input1").classList.toggle("show");
    }
    function filterFunction() {
        var input, filter, ul, li, a, i;
        input = document.getElementById("myInput");
        filter = input.value.toUpperCase();
        div = document.getElementById("input1");
        a = div.getElementsByTagName("a");
        for (i = 0; i < a.length; i++) {
            if (a[i].innerHTML.toUpperCase().indexOf(filter) > -1) {
                a[i].style.display = "";
            } else {
                a[i].style.display = "none";
            }
        }
    }
    function addline() {
        var x=document.getElementById("mybt").innerText;
        if (x!="添加技能"){
            var y=document.getElementById("abcd").value;
            var v=document.createElement("li");
            var w=document.getElementById("addskilltxt");
            v.className="myli";
            v.innerText=x+"("+y+")";
            w.appendChild(v);
            document.getElementById("mybt").innerText="添加技能";
        }

    }
    function getid(i) {
        var x=i.innerText;
        document.getElementById("mybt").innerText=x;
        // var x=i.innerText;
        // var w=document.getElementById("addskilltxt");
        // var y=w.innerText;
        // if (y.length==0){
        //     y="已选择的技能:"+x+"(默认熟练度掌握)";
        //     userskills= x+":2";
        // }
        // else {
        //     var z=y.split("熟练度");
        //     if (z.length==2){
        //         y=y.split("(默认熟练度掌握)")[0]+"(掌握)"
        //     }
        //     y=y+","+x+"(默认熟练度掌握)";
        //     userskills=userskills+ ","+x+":2";
        // }
        document.getElementById("input1").classList.remove("show");
        document.getElementById("input1").classList.add("hide");
        // w.innerText=y;
    }
    // function changeclass() {
    //     // console.log("d点击");
    //     var w=document.getElementById("addskilltxt").innerText;
    //     var y=document.getElementById("abcd").value;
    //     y="("+y+")";
    //     console.log(y)
    //     var x=w.split("(默认熟练度掌握)");
    //     if (x.length==2){
    //         w=x[0]+y;
    //     }
    //     else {
    //         var z=w.split("(");
    //         w="";
    //         for (var i=0;i<(z.length-1);i++){
    //             w=w+"("+z[i];
    //         }
    //         w=w+y;
    //     }
    //     document.getElementById("addskilltxt").innerText=w;
    // }
<!--    展示所有技能信息-->
    function getskillnames() {
        $.post("http://localhost:8080/Untitled/common/queryAllSkill",
        function (data) {
            // console.log(data);
            var z=data.list.split("[");
            var y=z[1].split("]");
            var x=y[0].split(",");
            var w=document.getElementById("input2");
            var v="";
            num=x.length;
            for (var i =0;i<x.length;i++){
                v=v+"<a class='handle' onclick='getid(i"+i+")' id='i"+i+"' >"+x[i]+"</a>";
            }
            w.innerHTML=v;
        })
    }
    new getskillnames();


    //获取已有技能
    function getskills() {
        $.post("http://localhost:8080/Untitled/user/querySkill",
        function (data) {
            console.log(data);
            var z=data.list.split("[")[1];
            var y=z.split("]")[0];
            var x=y.split(",");
            console.log(x);
            for (var i=0;i<x.length;i++){
                console.log(x[i]);
                new showskills(x[i],i);
            }
        })
    }
<!--    展示技能的动态添加-->
    function showskills(name,i) {
        var x=document.getElementById('oldskill');
        var y=document.createElement("li");
        var z=name.split(":");
        var c="";
        switch (z[1]) {
            case 1:c="了解";break;
            case 2:c="掌握";break;
            case 3:c="熟悉";break;
            case 4:c="精通";break;
            case 5:c="大师";break;
        }
        y.className="listyle";
        var  z="<a id='b"+i+"'>"+z[0]+"("+c+")"+"</a><button onclick='deletebtn(b"+i+")' style='float: right;background-color: #0e90d2' class=\"btn btn-primary btnstyle\" > 删除</button>"
        y.innerHTML=z;
        x.appendChild(y);
    // <a >Bootstrap Forms</a><button class="btn btn-primary btnstyle" > 删除</button>
    }
    new getskills();


    $('#clear').on('click',function () {
        var x=document.getElementById('addskilltxt');
        var y=x.lastChild;
        if (y==null){
            alert("已完全删除！");
        }
        else {
            x.removeChild(y);
        }
        // console.log(x);
        // if (x!=""){
        //     var y=x.split(",");
        //     console.log(y);
        //     if(y.length==1){
        //         document.getElementById('addskilltxt').innerText="";
        //     }
        //     else{
        //         var z="";
        //         for (var i=0;i<(y.length-1);i++) {
        //             if (z==""){
        //                 z=z+y[i];
        //             }
        //             else {
        //                 z=z+','+y[i];
        //             }
        //
        //         }
        //         console.log(z);
        //         document.getElementById('addskilltxt').innerText=z;
        //     }
        // }
        // else{
        //     alert("已完全删除")
        // }
    });
    //获取用户选择，并提交进数据库
    $('#add').on('click',function () {
        var x=document.getElementById('addskilltxt').innerText;
        var data1={};
        var s="";
        if (x!=null){
            var y=x.split("\n");
            for (var i=0;i<y.length;i++){
                var c;
                var z=y[i].split(")")[0].split("(");
                switch (z[1]) {
                    case "了解":c=1;break;
                    case "掌握":c=2;break;
                    case "熟悉":c=3;break;
                    case "精通":c=4;break;
                    case "大师":c=5;break;
                }
                if (i==0){
                    s=z[0]+":"+c;
                }
                else {
                    s=s+","+z[0]+":"+c;
                }
            }
            console.log(s);
            data1.skill=s;
            $.post("http://localhost:8080/Untitled/user/addSkill",
                data1,
                function (data) {
                    if (data.status==3){
                        document.getElementById('addskilltxt').innerText="";
                        alert("添加成功！");
                        document.getElementById('oldskill').innerHTML="";
                        new getskills();
                    }
                    else {
                        alert("提交失败！");
                    }

                });

        }

        // if (x!=""){
        //     var y=x.split(":")[1];
        //     var data1={};
        //     data1.skill=y;
        //     $.post("http://localhost:8080/Untitled/user/addSkill",
        //     data1,
        //     function (data) {
        //         if (data.status==3){
        //             document.getElementById('addskilltxt').innerText="";
        //             alert("添加成功！");
        //             document.getElementById('oldskill').innerHTML="";
        //             new getskills();
        //         }
        //         else {
        //             alert("提交失败！");
        //         }
        //
        //     });
        // }
    });
</script>
<script type="text/javascript" src="assets/js/jquery-ui.min.js"></script>
<script type="text/javascript" src="assets/js/raphael-min.js"></script>
<script type="text/javascript" src="assets/js/bootstrap.js"></script>
<script type="text/javascript" src='assets/js/sparkline.js'></script>
<script type="text/javascript" src='assets/js/morris.min.js'></script>
<script type="text/javascript" src="assets/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.masonry.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.imagesloaded.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.facybox.js"></script>
<script type="text/javascript" src="assets/js/jquery.alertify.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.knob.js"></script>
<script type='text/javascript' src='assets/js/fullcalendar.min.js'></script>
<script type='text/javascript' src='assets/js/jquery.gritter.min.js'></script>
<script type="text/javascript" src="assets/js/realm.js"></script>

<script type="text/javascript" src="assets/js/select2.min.js"></script>
<script type="text/javascript" src="assets/js/bootstrap-colorpicker.js"></script>
<script type="text/javascript" src="assets/js/bootstrap-datepicker.js"></script>
<script type="text/javascript" src="assets/js/bootstrap-timepicker.js"></script>
</body>
</html>