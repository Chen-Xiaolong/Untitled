<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>就业分析系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Bluth Company">
    <link rel="shortcut icon" href="assets/ico/favicon.html">
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <link href="assets/css/theme.css" rel="stylesheet">
    <link href="assets/css/font-awesome.min.css" rel="stylesheet">
    <link href="assets/css/alertify.css" rel="stylesheet">
    <link rel="Favicon Icon" href="favicon.ico">
    <style>
        .file {
            position: relative;
            display: inline-block;
            /*background: #D0EEFF;*/
            /*border: 1px solid #99D3F5;*/
            border-radius: 4px;
            padding: 4px 12px;
            overflow: hidden;
            height: 62px;
            /*color: #1E88C7;*/
            text-decoration: none;
            text-indent: 0;
            line-height: 20px;
        }
        .file input {
            position: absolute;
            font-size: 100px;
            right: 0;
            top: 0;
            opacity: 0;
        }
        .file:hover {
            /*background: #AADFFD;*/
            /*border-color: #78C3F3;*/
            /*color: #004974;*/
            text-decoration: none;
        }
    </style>
<!--    <link href="http://fonts.useso.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css">-->
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>
<div id="wrap">
    <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container-fluid">
                <div class="logo">
                    <img src="assets/img/logo.png" alt="Realm Admin Template">
                </div>
                <a class="btn btn-navbar visible-phone" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>
                <a class="btn btn-navbar slide_menu_left visible-tablet">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>

                <div class="top-menu visible-desktop">
                    <ul class="pull-left">
                        <li><a id="messages" data-notification="2" href="#"><i class="icon-envelope"></i> 信息</a></li>
                    </ul>
                    <ul class="pull-right">
                        <li><a href="../../Untitled/login/index.html"><i class="icon-off"></i> 退出</a></li>
                    </ul>
                </div>

                <div class="top-menu visible-phone visible-tablet">
                    <ul class="pull-right">
                        <li><a title="link to View all Messages page, no popover in phone view or tablet" href="#"><i class="icon-envelope"></i></a></li>
                        <li><a title="link to View all Notifications page, no popover in phone view or tablet" href="#"><i class="icon-globe"></i></a></li>
                        <li><a href="login.html"><i class="icon-off"></i></a></li>
                    </ul>
                </div>

            </div>
        </div>
    </div>

    <div class="container-fluid">

        <!-- Side menu -->
        <div class="sidebar-nav nav-collapse collapse">
            <div class="user_side clearfix">
                <img src="assets/img/odinn.jpg" alt="Odinn god of Thunder">
                <h5>管理员</h5>
                <a href="#"><i class="icon-cog"></i> 管理中心</a>
            </div>
            <div class="accordion" id="accordion2">

                <div class="accordion-group">
                    <div class="accordion-heading">
                        <a class="accordion-toggle b_F6F1A2" href="tasks.html"><i class="icon-tasks"></i> <span>数据管理</span></a>
                    </div>
                </div>


            </div>
        </div>
        <!-- /Side menu -->

        <!-- Main window -->
        <div class="main_container" id="tables_page">
            <div class="row-fluid">
                <ul class="breadcrumb">
                    <li><a href="#">管理员</a> <span class="divider">/</span></li>
                    <li class="active">数据管理</li>
                </ul>
                <h2 class="heading">
                    数据管理
<!--                    <div class="btn-group pull-right">-->
<!--                        <button class="btn"><i class="icon-download-alt"></i> Export</button>-->
<!--                        <button class="btn"><i class="icon-cog"></i> Settings</button>-->
<!--                    </div>-->
                </h2>
            </div> <!-- /row-fluid -->
            <div class="row-fluid">



                <div class="widget widget-padding span6">
                    <div class="widget-header">
                        <i class="icon-circle"></i>
                        <h5>管理</h5>
                        <div class="widget-buttons">
                            <a href="#" data-title="Collapse" data-collapsed="false" class="tip collapse"><i class="icon-chevron-up"></i></a>
                        </div>
                    </div>
<!--                    <div class="widget-header-under"><i>btn btn-small btn-box span2</i></div>-->
                    <div class="widget-body" style="height: 380px;">
                        <div class="row-fluid" style="margin-bottom:15px;">
                            <a href="javascript:;" class="file btn btn-small btn-box span2 tips"><i class="icon-circle-arrow-up"></i><span>上传数据</span>
                                <input type="file" accept='text/plain' onchange='openFile(event)'>
                            </a>
<!--                            <input type='file' name="上传数据" accept='text/plain' onchange='openFile(event)'>-->
<!--                            <a class="btn btn-small btn-box span2 tips" href="#" ><i class="icon-circle-arrow-up"></i><span>上传数据</span></a>-->
                            <a class="btn btn-small btn-box span2 tips" href="#" onclick="recom()"><i class="icon-cogs"></i><span>推荐建模</span></a>
                            <a class="btn btn-small btn-box span2 tips" href="#" ><i class="icon-envelope"></i><span>发放信息</span></a>
                            <a class="btn btn-small btn-box span2 tips" href="#" ><i class="icon-list-alt"></i><span>删除数据</span></a>
                            <a class="btn btn-small btn-box span2" href="#"  ><i class="icon-user"></i><span>用户管理</span></a>
                            <a class="btn btn-small btn-box span2 tips" href="#" ><i class="icon-search"></i><span>搜索</span></a>
                        </div>
<!--                        <div class="row-fluid" style="margin-bottom:15px;">-->
<!--                            <a class="btn btn-small btn-box bubble bubble-info span2 tips" href="#" data-title="bubble-info" data-bubble="7k"><i class="icon-thumbs-up"></i><span>Likes</span></a>-->
<!--                            <a class="btn btn-small btn-box bubble bubble-info span2 tips" href="#" data-title="bubble-info" data-bubble="10"><i class="icon-twitter"></i><span>Tweets</span></a>-->
<!--                            <a class="btn btn-small btn-box span2 " href="#"><i class="icon-money"></i><span>Finance</span></a>-->
<!--                            <a class="btn btn-small btn-box bubble bubble-success span2  tips" href="#" data-title="bubble-success" data-bubble="8.4"><i class="icon-star-empty"></i><span>Rating</span></a>-->
<!--                            <a class="btn btn-small btn-box span2" href="#"><i class="icon-map-marker"></i><span>Map</span></a>-->
<!--                            <a class="btn btn-small btn-box bubble bubble-warning span2 tips" href="#" data-title="bubble-warning" data-bubble="5"><i class="icon-globe"></i><span>Region</span></a>-->

<!--                        </div>-->
                        <div class="field-wrap">
                            <input type="text" id="rebuild" placeholder="岗位名称.." style="margin-top: 10px" required autocomplete="off"/>
                            <button class="btn" type="button" onclick="addname('rebuild')">岗位建模</button>
                        </div>
                        <div class="field-wrap">
                            <input type="text" id="newskill" placeholder="技能名称.." style="margin-top: 10px" required autocomplete="off"/>
                            <button class="btn" type="button"  onclick="addname('newskill')">新增技能</button>
                        </div>
                        <div class="field-wrap">
                            <input type="text" id="newduty" placeholder="岗位名称..." style="margin-top: 10px" required autocomplete="off"/><br>
                            <input type="text" id="discribe" placeholder="岗位描述(请勿超过128字符)..." style="margin-top: 10px; width: 500px" required autocomplete="off"/><br>
                            <button class="btn" type="button" onclick="addname('newduty')">新增岗位</button>
                        </div>


                    </div><!--/widget-body-->
                </div><!-- /widget -->

            </div><!-- /row-fluid -->


            <div class="row-fluid">
                <div class="widget widget-padding span12">
                    <div class="widget-header">
                        <i class="icon-circle"></i>
                        <h5>操作结果</h5>
                        <div class="widget-buttons">
                            <a href="#" data-title="Collapse" data-collapsed="false" class="tip collapse"><i class="icon-chevron-up"></i></a>
                        </div>
                    </div>
                    <div class="widget-body row-fluid" style="height: 200px" id="retu">

                    </div><!--/widget-body-->
                </div><!-- /widget -->
            </div> <!-- /row-fluid -->

        </div>
        <!-- /Main window -->

    </div><!--/.fluid-container-->
</div><!-- wrap ends-->
<script>
    function addname(name) {
        var w=document.getElementById('retu');
        var v=document.createElement('li');
        if (name=='rebuild'){
            var data1={};
            var x=document.getElementById('rebuild').innerText;
            data1.duty=x;
            $.post('http://localhost:8080/Untitled/admin/analyseModeling',
            data1,
            function (data) {
                if (data.status==3) {
                    document.getElementById('rebuild').innerText="";
                    v.innerText="正在重新岗位建模!";
                }
                else {
                    v.innerText="岗位建模失败!";
                }
            });
        }
        else {
            var data2={};
            var x=document.getElementById(name).innerText;
            if (name=="newskill"){
                data2.skill=x;
                $.post("http://localhost:8080/Untitled/admin/addSkill",
                data2,
                function (data) {
                   if (data.status==3){
                       v.innerText="添加技能成功!";
                   }
                   else {
                       v.innerText="添加技能失败!";
                   }
                });
            }
            else {
                data2.description=document.getElementById("discribe").innerText;
                data2.duty=x;
                $.post("http://localhost:8080/Untitled/admin/addDuty",
                data2,
                function (data) {
                    if (data.status==3)
                        v.innerText="添加岗位成功!";
                    else {
                        v.innerText="添加岗位失败!";
                    }
                });
            }
        }
        w.appendChild(v);
    }
    function recom() {
        var w=document.getElementById('retu');
        var v=document.createElement('li');
        $.post("http://localhost:8080/Untitled/admin/recommendModeling",
        function (data) {
            if (data.status==3){
                v.innerText="正在重新推荐建模!";
            }
            else{
                v.innerText="推荐建模失败!";
            }
        });
        w.appendChild(v);
    }
    function openFile(event) {
        var w=document.getElementById('retu');
        var input = event.target;
        var reader = new FileReader();
        reader.onload = function() {
            if(reader.result) {
                //显示文件内容
                // console.log(reader.result);
                var x=reader.result.split("\n");
                for (var i=0;i<x.length;i++){
                    var v=document.createElement('li');
                    var data1={};
                    var flag=1;
                    var y=x[i].split(',');
                    console.log(y);
                    data1.duty=y[0];
                    var s=y[1];
                    for (var j=2;j<y.length;j++){
                        // console.log(y[i]);
                        s=s+","+y[j];
                    }
                    data1.skills=s;
                    console.log(data1);
                    $.post('http://localhost:8080/Untitled/admin/addEmployment',
                    data1,
                    function (data) {
                        console.log(data);
                        if (data.status==3){
                            v.innerText="成功推荐数据:"+x[i];
                        }
                        else {
                            v.innerText="添加数据："+x[i]+"失败";
                        }
                        w.appendChild(v);
                    });
                }

                // console.log(x[0]);
                // console.log(x[1]);
            }
        };
        reader.readAsText(input.files[0]);
    }
</script>
<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery-ui.min.js"></script>
<script type="text/javascript" src="assets/js/raphael-min.js"></script>
<script type="text/javascript" src="assets/js/bootstrap.js"></script>
<script type="text/javascript" src='assets/js/sparkline.js'></script>
<script type="text/javascript" src='assets/js/morris.min.js'></script>
<script type="text/javascript" src="assets/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.masonry.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.imagesloaded.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.facybox.js"></script>
<script type="text/javascript" src="assets/js/jquery.alertify.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.knob.js"></script>
<script type='text/javascript' src='assets/js/fullcalendar.min.js'></script>
<script type='text/javascript' src='assets/js/jquery.gritter.min.js'></script>
<script type="text/javascript" src="assets/js/realm.js"></script>
</body>
</html>
